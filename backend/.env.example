# ==============================================
# üîô BACKEND CONFIGURATION
# ==============================================
# Copy this file to .env in the backend directory.

# Server Settings
PORT=3001
NODE_ENV=development

# Database Connection (Prisma/PostgreSQL)
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=SCHEMA
DATABASE_URL="postgresql://user:password@host:port/database?sslmode=require"

# Redis Connection (Caching & Queues)
REDIS_URL="redis://localhost:6379"

# Security & Authentication
JWT_SECRET="supersecretkey123"
# Allowed origins for CORS. Comma-separated.
# Allowed origins for CORS. Comma-separated.
FRONTEND_URL="http://localhost:8080,http://localhost:5173"

# Rate Limiting Configuration
# ---------------------------
# Controls the maximum number of requests allowed within a specific time window.

# Global Rate Limit: Applies to ALL API requests (scans, history, etc.)
# Prevents DDoS and general abuse of the server.
RATE_LIMIT_WINDOW_MS=900000 # Time window in milliseconds (15 minutes)
RATE_LIMIT_MAX=10000        # Max requests per IP per window (Local: 10000, Prod: 500)

# Auth Rate Limit: Applies ONLY to Login, Signup, and OTP verification
# Prevents brute-force password guessing and OTP spam.
AUTH_RATE_LIMIT_WINDOW_MS=3600000 # Time window in milliseconds (1 hour)
AUTH_RATE_LIMIT_MAX=10000         # Max auth attempts per IP per window (Local: 10000, Prod: 10)

# Email Service (Resend)
# SMTP Configuration (KSDC Relay)
SMTP_HOST="relay.nic.in"
SMTP_PORT="587"
SMTP_USER="noreply@domainscope.kerala.gov.in"
SMTP_PASS="your_smtp_password"
SMTP_SECURE="false" # Set to true for port 465

# Legacy (Optional)
RESEND_API_KEY="re_123456789"

# ==============================================
# üîë EXTERNAL INTELLIGENCE API KEYS
# ==============================================
# The backend services rely on these keys to perform scans.
# Explicit backend keys are preferred over VITE_ keys.

# VirusTotal (Supports multiple keys for rotation)
VT_API_KEY=your_vt_key_primary
VT_API_KEY_2=optional_backup_key_2
VT_API_KEY_3=optional_backup_key_3
# Fallback: The backend will also check VITE_VIRUSTOTAL_API_KEY if these are missing.

# IPInfo (IP Intelligence - VPN/Proxy/Tor Detection, Geolocation)
# Supports up to 3 tokens for rotation/fallback
IPINFO_TOKEN=your_ipinfo_token_here
IPINFO_TOKEN_2=your_second_token_here
IPINFO_TOKEN_3=your_third_token_here
# Get your free token at: https://ipinfo.io/signup

# Proxycheck (VPN/Proxy Detection)
# Used to enhance VPN detection when IPInfo free tier falls short.
PROXYCHECK_API_KEY=your_proxycheck_key_here
PROXYCHECK_API_KEY_2=your_proxycheck_key_2_here
PROXYCHECK_API_KEY_3=your_proxycheck_key_3_here

# AbuseIPDB (Supports multiple keys for rotation)
ABUSEIPDB_API_KEY=your_abuseipdb_key_primary
ABUSEIPDB_API_KEY_2=optional_backup_key_2
ABUSEIPDB_API_KEY_3=optional_backup_key_3
# Fallback: The backend will also check VITE_ABUSEIPDB_API_KEY if these are missing.

# ==============================================
# üÜï NEW OSINT SERVICE API KEYS (Free Tier)
# ==============================================

# Google Safe Browsing (Free: 10,000 requests/day = 300,000/month!)
# Get your API key at: https://developers.google.com/safe-browsing/v4/get-started
GOOGLE_SAFE_BROWSING_KEY=your_google_safe_browsing_key_here
GOOGLE_SAFE_BROWSING_KEY_2=optional_backup_key_2
GOOGLE_SAFE_BROWSING_KEY_3=optional_backup_key_3

# URLScan.io (Free: ~1,000 requests/day = 30,000/month)
# Get your API key at: https://urlscan.io/user/signup
URLSCAN_API_KEY=your_urlscan_key_here
URLSCAN_API_KEY_2=optional_backup_key_2
URLSCAN_API_KEY_3=optional_backup_key_3

# AlienVault OTX - Open Threat Exchange (Free: Unlimited requests!)
# Get your API key at: https://otx.alienvault.com/api
ALIENVAULT_OTX_KEY=your_otx_key_here
ALIENVAULT_OTX_KEY_2=optional_backup_key_2
ALIENVAULT_OTX_KEY_3=optional_backup_key_3

# IP2Location (Geolocation & Proxy Detection)
# Get your free API key at: https://www.ip2location.io/pricing
IP2LOCATION_API_KEY=your_ip2location_key_here
IP2LOCATION_API_KEY_2=optional_backup_key_2
IP2LOCATION_API_KEY_3=optional_backup_key_3

# ==============================================
# üìù NOTES ON FREE SERVICES (No API Key Needed)
# ==============================================
# The following services are completely FREE and require NO API keys:
#
# ‚úÖ Extended DNS Records (MX, NS, TXT, AAAA, CNAME, SOA, CAA, PTR) - Native DNS
# ‚úÖ Email Security (SPF, DKIM, DMARC, BIMI) - DNS-based checks
# ‚úÖ SSL/TLS Certificate Analysis - Native TLS inspection  
# ‚úÖ HTTP Security Headers - Direct HTTP requests
# ‚úÖ Wayback Machine (Internet Archive) - Unlimited, no key required
# ‚úÖ PhishTank - Database downloads, no API needed
# ‚úÖ WHOIS/RDAP - Native protocols (rate limited by servers)
# ‚úÖ crt.sh (Certificate Transparency) - Already integrated
#
# These services provide UNLIMITED requests at $0 cost!

